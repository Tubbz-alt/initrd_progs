#!/bin/sh
# * $applet_list is generated by busybox_static.petbuild
#   after compiling a busybox compatible with the os arch
# * This script can be called from anywhere and will
#   always work in the directory it is located in
# * First try to use actual applet list, otherwise fall back to $applet_list

applet_list='[ [[ ash awk basename bbconfig beep blkid blockdev bunzip2 bzcat bzip2 cat chattr chgrp chmod chown chroot cksum clear comm cp cpio cut date dc dd depmod devmem df dirname dmesg dos2unix du echo eject env expand expr false fatattr fdisk find findfs flock fold free freeramdisk fsck fstrim fsync getopt guess_fstype gunzip gzip halt hd hdparm head hexdump hwclock init insmod kill killall klogd less ln loadfont loadkmap logger login logname logread losetup ls lsattr lsmod lsof lspci lsusb lzcat lzma makedevs mdev mkdir mkdosfs mke2fs mkfifo mkfs.ext2 mkfs.reiser mkfs.vfat mknod mkswap mktemp modinfo modprobe more mount mpstat mv nice nmeter nohup od passwd pgrep pidof pipe_progress pivot_root pkill pmap poweroff printenv printf ps pstree pwd pwdx rdev readlink realpath reboot renice rev rm rmdir rmmod sed seq setfont setkeycodes setlogcons setserial sh sha1sum sha256sum sha3sum sha512sum showkey shuf sleep sort split stat stty sum swapoff swapon switch_root sync sysctl syslogd tac tail tar tee test time timeout top touch tr true truncate tty tune2fs uevent umount uname uncompress unexpand uniq unix2dos unlink unlzma unxz unzip uptime usleep uudecode uuencode vercmp volname waitmax wc which whoami xargs xz xzcat yes zcat '

sdir=$(dirname "$0")

if [ -f "$sdir/busybox" ] ; then
	alist=$($sdir/busybox --list)
	if [ "x$alist" = "x" ] ; then
		alist="$applet_list"
	fi
	for a in $alist ; do
		[ ! -e "$a" ] && ln -s busybox "$sdir/$a"
	done
fi

